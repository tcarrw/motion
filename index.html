<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Motion — Home</title>
<meta name="description" content="Motion Home: set BPM, trigger the green→pink wipe, and jump to Miss Monique or Dagny. Auto-arm when Harbor is green." />
<style>
  :root{
    --bg:#070b0a; --ink:#ecfffb; --muted:#a7c0ba;
    --green:#79e0c8; --green2:#73e3c5; --pink:#ff39a8; --pink2:#ff79c6;
    --grid:#14211d; --shadow:0 16px 40px rgba(0,0,0,.55);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    background:radial-gradient(1200px 900px at 70% 12%, #0a1412 0%, #070b0a 60%, #050807 100%);
    font:500 16px/1.45 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }
  .wrap{max-width:1100px; margin:0 auto; padding:22px; display:grid; gap:14px}
  .hdr{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
  .title{font-weight:900; font-size:24px; letter-spacing:.28px; text-transform:uppercase}
  .tag{font:700 11px ui-monospace,SFMono-Regular,Menlo,monospace; padding:4px 8px; border-radius:999px; border:1px solid rgba(182,255,240,.35); color:#ddfff8; background:rgba(121,224,200,.07)}

  .card{
    background:linear-gradient(180deg, rgba(10,18,16,.92), rgba(7,11,10,.92));
    border:1px solid rgba(140,200,190,.22); border-radius:16px; padding:16px; box-shadow:var(--shadow);
    backdrop-filter:saturate(130%) blur(6px);
  }
  h2{margin:0 0 8px 0; font-size:18px; letter-spacing:.2px}
  .muted{color:var(--muted); font-size:14px}

  .stage{
    position:relative; border:1px solid var(--grid); border-radius:16px; overflow:hidden; margin-top:8px;
    background:radial-gradient(800px 220px at 50% 105%, rgba(121,224,200,.08), transparent 60%), linear-gradient(180deg, rgba(10,18,16,.6), rgba(5,8,7,.8));
    min-height:260px;
  }
  .split{position:absolute; inset:0; display:grid; grid-template-columns:1fr 1fr}
  .left,.right{position:relative; display:flex; align-items:center; justify-content:center; padding:18px}
  .left::before,.right::before{
    content:""; position:absolute; inset:0; opacity:.18; filter:blur(.6px); mix-blend-mode:screen;
  }
  .left::before{ background:radial-gradient(closest-side, rgba(121,224,200,.6), rgba(121,224,200,.25), transparent) }
  .right::before{ background:radial-gradient(closest-side, rgba(255,121,198,.55), rgba(255,57,168,.25), transparent) }
  .badge{
    font:900 12px ui-monospace,SFMono-Regular,Menlo,monospace; letter-spacing:.16em; text-transform:uppercase;
    padding:8px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.28); background:rgba(255,255,255,.06);
  }
  .wipe{
    position:absolute; inset:0; pointer-events:none;
    background:linear-gradient(90deg, rgba(121,224,200,.15) 0%, rgba(121,224,200,.0) 48%, rgba(255,57,168,.0) 52%, rgba(255,57,168,.18) 100%);
    opacity:0; transform:translateX(-12%); transition:opacity .35s ease, transform .6s cubic-bezier(.22,.61,.36,1);
  }
  .wipe.on{ opacity:1; transform:translateX(0) }

  .tiles{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:12px }
  @media (max-width:880px){ .tiles{ grid-template-columns: 1fr } }
  .tile{
    display:flex; align-items:center; justify-content:space-between; gap:12px; text-decoration:none; color:var(--ink);
    border:1px solid rgba(140,200,190,.28); border-radius:14px; padding:14px; background:rgba(255,255,255,.04);
  }
  .tile:hover{ filter:brightness(1.06) }
  .tleft{ display:flex; flex-direction:column; gap:6px }
  .name{ font-weight:900; letter-spacing:.3px }
  .sub{ color:var(--muted); font-size:12px }
  .btn{
    display:inline-flex; align-items:center; gap:8px; padding:9px 12px; border-radius:10px; text-decoration:none; cursor:pointer;
    border:1px solid rgba(182,255,240,.45); color:#ecfffb; font-weight:800; letter-spacing:.14em; text-transform:uppercase;
    background:linear-gradient(180deg, rgba(121,224,200,.18), rgba(121,224,200,.08));
  }
  .btn.pink{ border-color:rgba(255,57,168,.55); background:linear-gradient(180deg, rgba(255,57,168,.16), rgba(255,57,168,.06)) }

  .ctrl{
    display:grid; gap:10px; margin-top:10px; border:1px solid var(--grid); border-radius:12px; padding:12px; background:rgba(255,255,255,.03);
  }
  .row{display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap}
  .chip{
    font:700 11px ui-monospace,SFMono-Regular,Menlo,monospace; padding:4px 8px; border-radius:999px; border:1px solid rgba(182,255,240,.35); color:#ddfff8
  }
  .chip.ok{ border-color:rgba(115,227,197,.85); color:#eafff8; background:rgba(121,224,200,.12) }
  .chip.warn{ border-color:rgba(255,208,137,.85); color:#fff3dc; background:rgba(255,208,137,.1) }

  /* Auto-Arm switch */
  .switch{ position:relative; width:52px; height:28px; border-radius:999px; border:1px solid rgba(182,255,240,.45); background:rgba(121,224,200,.1); cursor:pointer }
  .switch .knob{ position:absolute; top:3px; left:3px; width:22px; height:22px; border-radius:50%; background:#ecfffb; box-shadow:0 2px 8px rgba(0,0,0,.35); transition:.15s }
  .switch.on{ border-color:rgba(255,57,168,.6); background:linear-gradient(180deg, rgba(255,57,168,.18), rgba(255,57,168,.08)) }
  .switch.on .knob{ left:27px }

  input[type=range]{ width:100% }

  /* Now Playing tile */
  .nowplay{
    display:none; align-items:center; justify-content:space-between; gap:8px; margin-top:10px;
    border:1px solid rgba(121,224,200,.45); border-left:4px solid var(--green); border-radius:12px; padding:10px;
    background:linear-gradient(180deg, rgba(121,224,200,.12), rgba(121,224,200,.06));
  }
  .np-left{display:flex; flex-direction:column; gap:4px}
  .np-title{font-weight:900; letter-spacing:.2px}
  .np-sub{color:var(--muted); font-size:12px}
  .np-btn{
    display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:10px;
    border:1px solid rgba(182,255,240,.45); background:rgba(121,224,200,.07); color:#ecfffb; text-decoration:none; font-weight:800; letter-spacing:.14em; text-transform:uppercase;
  }

  .foot{ text-align:center; color:var(--muted); font-size:12px; padding:8px 0 16px }
</style>
</head>
<body>
  <main class="wrap">
    <header class="hdr">
      <div class="title">Motion</div>
      <div class="tag">green room · ready</div>
    </header>

    <section class="card">
      <h2>Green → Pink Wipe</h2>
      <p class="muted">Slide the BPM. At <strong>127+</strong> the room flips — Motion (green) hands to Dagny (pink). Harbor status (if set here) shows below.</p>

      <div class="stage">
        <div class="split">
          <div class="left">
            <span class="badge" style="border-color:rgba(121,224,200,.65); color:#eafff8">Miss Monique · Motion</span>
          </div>
          <div class="right">
            <span class="badge" style="border-color:rgba(255,57,168,.6); color:#ffe7f5">Dagny · Pink Floor</span>
          </div>
        </div>
        <div class="wipe" id="wipe" aria-hidden="true"></div>
      </div>

      <div class="ctrl">
        <div class="row">
          <div class="row" style="gap:8px">
            <span id="bpm-chip" class="chip">BPM 126</span>
            <span id="harbor-chip" class="chip warn">harbor: pending</span>
          </div>
          <div class="row" style="gap:12px">
            <div class="chip" style="display:flex; align-items:center; gap:8px">
              Auto-Arm
              <span id="auto" class="switch" role="switch" aria-checked="false" tabindex="0"><span class="knob"></span></span>
            </div>
            <button class="btn" id="set-124" type="button">124</button>
            <button class="btn" id="set-126" type="button">126</button>
            <button class="btn" id="set-127" type="button">127</button>
            <button class="btn" id="set-128" type="button">128</button>
          </div>
        </div>
        <input id="bpm" type="range" min="120" max="132" value="126" step="1" aria-label="BPM">

        <!-- Now Playing (appears only when wipe is ON ≥127) -->
        <div id="nowplay" class="nowplay">
          <div class="np-left">
            <div class="np-title">Now Playing — Miss Monique</div>
            <div class="np-sub">Progressive House Set · YouTube search</div>
          </div>
          <a class="np-btn" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=Miss+Monique+Progressive+House+Set">Open</a>
        </div>
      </div>

      <div class="tiles">
        <a class="tile" href="https://motion.plnt.earth/monique" rel="noopener">
          <div class="tleft">
            <div class="name">Miss Monique — Flow Deck</div>
            <div class="sub">Pump the beats · Green room</div>
          </div>
          <span class="btn">Open</span>
        </a>

        <a class="tile" href="https://dagny.plnt.earth" rel="noopener">
          <div class="tleft">
            <div class="name">Dagny — Joy in Motion</div>
            <div class="sub">Pink floor · Harbor-linked</div>
          </div>
          <span class="btn pink">Open</span>
        </a>
      </div>
    </section>

    <footer class="foot">Motion hands to Dagny when the field is ready. Wipe at 127+ is a hint, not a rule.</footer>
  </main>

<script>
(function(){
  var wipe = document.getElementById('wipe');
  var bpm = document.getElementById('bpm');
  var chip = document.getElementById('bpm-chip');
  var harborChip = document.getElementById('harbor-chip');
  var np = document.getElementById('nowplay');
  var auto = document.getElementById('auto');

  function truthy(v){
    if(v==null) return false;
    var s = String(v).toLowerCase().trim();
    return !(s===""||s==="0"||s==="false"||s==="null"||s==="undefined");
  }

  // Harbor status
  var credit  = truthy(localStorage.getItem('harbor.credit'));
  var consent = truthy(localStorage.getItem('harbor.consent'));
  var resource= truthy(localStorage.getItem('harbor.resource'));
  var harborAll = credit && consent && resource;
  harborChip.textContent = harborAll ? 'harbor: green' : 'harbor: pending';
  harborChip.classList.toggle('ok', harborAll);
  harborChip.classList.toggle('warn', !harborAll);

  // Auto-Arm persistence
  var autoOn = localStorage.getItem('motion.home.autoArm') === 'true';
  function renderAuto(){
    auto.classList.toggle('on', autoOn);
    auto.setAttribute('aria-checked', autoOn ? 'true' : 'false');
  }
  function saveAuto(){
    try{ localStorage.setItem('motion.home.autoArm', autoOn ? 'true' : 'false'); }catch(e){}
  }
  function toggleAuto(){
    autoOn = !autoOn; renderAuto(); saveAuto(); maybeAutoArm();
  }
  auto.addEventListener('click', toggleAuto, {passive:true});
  auto.addEventListener('keydown', function(e){ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); toggleAuto(); }});
  renderAuto();

  function setBPM(v){
    v = Math.max(120, Math.min(132, parseInt(v||126,10)));
    bpm.value = v;
    chip.textContent = 'BPM ' + v;
    try{ localStorage.setItem('motion.home.bpm', String(v)); }catch(e){}
    var on = v >= 127;
    wipe.classList.toggle('on', on);
    np.style.display = on ? 'flex' : 'none';
    return v;
  }
  // initial BPM
  setBPM(localStorage.getItem('motion.home.bpm')||126);

  function maybeAutoArm(){
    if(harborAll && autoOn){
      var cur = parseInt(bpm.value,10);
      if(cur < 127) setBPM(127);
      // lock wipe on (visual), but still allow manual lowering if desired
      wipe.classList.add('on');
      np.style.display = 'flex';
    }
  }
  maybeAutoArm();

  bpm.addEventListener('input', function(e){
    setBPM(e.target.value);
    // if autoOn + harborAll and user drags below 127, we don't fight — we let them.
  }, {passive:true});

  document.getElementById('set-124').addEventListener('click', function(){ setBPM(124); }, {passive:true});
  document.getElementById('set-126').addEventListener('click', function(){ setBPM(126); }, {passive:true});
  document.getElementById('set-127').addEventListener('click', function(){ setBPM(127); }, {passive:true});
  document.getElementById('set-128').addEventListener('click', function(){ setBPM(128); }, {passive:true});
})();
</script>
</body>
</html>
