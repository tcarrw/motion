<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Motion · O-Tone (128 Hz)</title>

<!-- Open Graph -->
<meta property="og:title" content="Motion · O-Tone (128 Hz)">
<meta property="og:description" content="Hot To Go field trainer · 64 / 128 / 256 Hz · BPM-synced honey ring. One tap to feel the hive.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://motion.plnt.earth/">
<meta property="og:image" content="https://motion.plnt.earth/og/otone_og_1200x630.jpg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Motion · O-Tone (128 Hz)">
<meta name="twitter:description" content="Hot To Go field trainer · 64 / 128 / 256 Hz · BPM-synced honey ring. One tap to feel the hive.">
<meta name="twitter:image" content="https://motion.plnt.earth/og/otone_og_1200x630.jpg">

<!-- Mobile + Theme -->
<meta name="theme-color" content="#0b1110">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
:root { --bg:#0b1110; --fg:#d7ffe1; --gold:#ffdd66; --mint:#bfffd0; }
html,body{margin:0;height:100%;background:linear-gradient(180deg,#0b1110,#0e1715 40%,#0b1110);
color:var(--fg);font-family:ui-sans-serif,system-ui,Segoe UI,Helvetica,Arial}
.wrap{max-width:720px;margin:0 auto;padding:20px 16px 48px;display:flex;flex-direction:column;gap:18px}
h1{font-weight:700;letter-spacing:.3px;font-size:20px;margin:6px 0 0}
.tag{font-size:12px;opacity:.8}
.pill{padding:8px 10px;border-radius:999px;background:#12201c;font-size:12px}
.panel{display:flex;flex-wrap:wrap;gap:10px}
button,input[type="range"]{-webkit-appearance:none;appearance:none;border:none;
background:#182521;color:var(--fg);padding:12px 14px;border-radius:12px;font-size:14px;cursor:pointer}
button:active{transform:translateY(1px)}
.small{font-size:12px;opacity:.9}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.card{background:#101c18;border-radius:16px;padding:14px}
.row{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.meter{height:8px;background:#12201c;border-radius:999px;overflow:hidden}
.bar{height:100%;width:0;background:linear-gradient(90deg,var(--gold),#ffeaa6,var(--gold))}
canvas{width:100%;aspect-ratio:1/1;border-radius:24px;
background:radial-gradient(120% 120% at 50% 56%,#0d1a17 0%,#0b1110 60%,#09100e 100%)}
.hint{font-size:12px;opacity:.72}
</style>
</head>
<body>
<div class="wrap">
  <div>
    <div class="tag">motion.plnt.earth</div>
    <h1>O-Tone 128 Hz Swarm</h1>
    <div class="pill">Hot To Go field · 64 / 128 / 256 Hz</div>
  </div>

  <canvas id="viz" aria-label="O-tone visual"></canvas>

  <div class="panel">
    <button id="start">Activate O-Tone</button>
    <button id="stop" disabled>Stop</button>
    <button id="airplay">AirPlay</button>
  </div>

  <div class="grid">
    <div class="card">
      <div class="row">
        <label for="bpm" class="small">BPM</label>
        <input id="bpm" type="range" min="120" max="128" step="1" value="126"/>
        <div id="bpmOut" class="small">126</div>
      </div>
      <div class="row">
        <label for="gain" class="small">Field</label>
        <input id="gain" type="range" min="0" max="1" step="0.01" value="0.35"/>
        <div id="gainOut" class="small">0.35</div>
      </div>
      <div class="row">
        <label for="brightness" class="small">Shimmer</label>
        <input id="brightness" type="range" min="0" max="1" step="0.01" value="0.25"/>
        <div id="brightOut" class="small">0.25</div>
      </div>
    </div>

    <div class="card">
      <div class="small">
        Fundamental 128 Hz · Half 64 Hz · Harmonic 256 Hz
      </div>
      <div class="hint" style="margin-top:8px">
        Pulse = kick. Each beat opens the field then settles. Keep 124–128 BPM for entrainment.
      </div>
      <div class="meter" style="margin-top:12px"><div id="beatBar" class="bar"></div></div>
    </div>
  </div>

  <div class="hint">
    Tip: start around 126 BPM. Nudge to 128 for lift during the chorus. AirPlay to room speakers for swarm tests.
  </div>
</div>

<video id="airplayVideo" playsinline airplay="allow" style="display:none"></video>

<script>
let ctx, started=false, pulseGain, baseGain, subGain, fundGain, harmGain, shimmer, beatTimer, rafId;
function resize(){const w=canvas.clientWidth;canvas.width=w*2;canvas.height=w*2}
const canvas=document.getElementById('viz');const c=canvas.getContext('2d');resize();window.addEventListener('resize',resize);
function createAudio(){
  ctx=new (window.AudioContext||window.webkitAudioContext)({latencyHint:'interactive'});
  const dest=ctx.createMediaStreamDestination();document.getElementById('airplayVideo').srcObject=dest.stream;
  baseGain=ctx.createGain();pulseGain=ctx.createGain();shimmer=ctx.createGain();
  const sub=ctx.createOscillator(),fund=ctx.createOscillator(),harm=ctx.createOscillator();
  sub.type=fund.type=harm.type='sine';sub.frequency.value=64;fund.frequency.value=128;harm.frequency.value=256;
  subGain=ctx.createGain();fundGain=ctx.createGain();harmGain=ctx.createGain();
  subGain.gain.value=0.35;fundGain.gain.value=0.6;harmGain.gain.value=0.12;
  const shimmerOsc=ctx.createOscillator();shimmerOsc.type='triangle';shimmerOsc.frequency.value=6;
  const shimmerDepth=ctx.createGain();shimmerDepth.gain.value=0.03;shimmerOsc.connect(shimmerDepth).connect(fundGain.gain);
  sub.connect(subGain);fund.connect(fundGain);harm.connect(harmGain);
  const sum=ctx.createGain();subGain.connect(sum);fundGain.connect(sum);harmGain.connect(sum);
  sum.connect(shimmer).connect(pulseGain).connect(baseGain).connect(ctx.destination);baseGain.connect(dest);
  baseGain.gain.value=parseFloat(gain.value);shimmer.gain.value=parseFloat(brightness.value);
  sub.start();fund.start();harm.start();shimmerOsc.start();
}
function scheduleBeats(){
  clearInterval(beatTimer);
  const bpm=parseInt(bpmEl.value,10);const interval=60000/bpm;
  beatTimer=setInterval(()=>{
    const t=ctx.currentTime;const up=0.01,down=0.18;
    pulseGain.gain.cancelScheduledValues(t);
    pulseGain.gain.setValueAtTime(1.0,t);
    pulseGain.gain.linearRampToValueAtTime(1.65,t+up);
    pulseGain.gain.exponentialRampToValueAtTime(1.0,t+up+down);
    beatBar.style.transition='none';beatBar.style.width='0%';
    requestAnimationFrame(()=>{beatBar.style.transition=`width ${down*1000}ms linear`;beatBar.style.width='100%'});
  },interval);
}
function draw(){
  const w=canvas.width,h=canvas.height,t=performance.now()*0.001;
  c.clearRect(0,0,w,h);const cx=w/2,cy=h/2;
  const minR=Math.min(w,h)*0.22,bpm=parseInt(bpmEl.value,10);
  const beat=(t*(bpm/60))%1,ease=1-Math.pow(1-beat,3),r=minR+ease*minR*0.55;
  const grd=c.createRadialGradient(cx,cy,r*0.45,cx,cy,r*1.05);
  grd.addColorStop(0,'rgba(255,221,102,0.35)');grd.addColorStop(1,'rgba(154,243,194,0.06)');
  c.fillStyle=grd;c.beginPath();c.arc(cx,cy,r,0,Math.PI*2);c.fill();
  const alpha=0.55+Math.sin(t*2)*0.1+parseFloat(brightness.value)*0.2;
  c.lineWidth=Math.max(2,r*0.03);c.strokeStyle=`rgba(186,255,210,${alpha})`;
  c.beginPath();c.arc(cx,cy,r*0.86,0,Math.PI*2);c.stroke();
  rafId=requestAnimationFrame(draw);
}
const bpmEl=bpm,gainEl=gain,brightEl=brightness,beatBar=document.getElementById('beatBar');
start.onclick=async()=>{if(started)return;if(!ctx)createAudio();await ctx.resume();started=true;
start.disabled=true;stop.disabled=false;scheduleBeats();draw()};
stop.onclick=()=>{if(!started)return;started=false;start.disabled=false;stop.disabled=true;
clearInterval(beatTimer);if(rafId)cancelAnimationFrame(rafId);if(ctx&&ctx.state!=='closed')ctx.suspend()};
airplay.onclick=()=>{const v=document.getElementById('airplayVideo');
if(v&&typeof v.webkitShowPlaybackTargetPicker==='function')v.webkitShowPlaybackTargetPicker()};
bpmEl.oninput=()=>{bpmOut.textContent=bpmEl.value;if(started)scheduleBeats()};
gainEl.oninput=()=>{gainOut.textContent=gainEl.value;if(baseGain)baseGain.gain.value=parseFloat(gainEl.value)};
brightEl.oninput=()=>{brightOut.textContent=brightEl.value;if(shimmer)shimmer.gain.value=parseFloat(brightEl.value)};
document.addEventListener('visibilitychange',()=>{if(document.hidden&&ctx&&ctx.state==='running')ctx.suspend()});
</script>
</body>
</html>
